# MegaD nginx proxy
[![Donate](https://img.shields.io/badge/donate-Yandex-red.svg)](https://yoomoney.ru/to/410013955329136)

[Интеграция с HA](https://github.com/andvikt/mega_hacs.git)

## Установка

Вам нужно установить реппозиторий согласно [инструкции](https://github.com/andvikt/mega_addon)

Если у вас нет supervisor (он доступен только на HA OS), аддон установить не получится, в таком случае
вы можете либо воспользоваться docker:
```shell
# при условии что HA запущен на одной машине с docker
docker build -t mega-nginx . && docker run -d --network host mega-nginx
```
Или самостоятельно добавить соответсвующий конфиг (на примере `./nginx.conf`) в ваш nginx

## Описание

Простой nginx-прокси, сконфигурированный на proxy_pass 8124->8123

Изначальная проблема в том, что HA построен на асинхронном вебсервере, который имеет
свойство разбивать пакеты, с чем контроллер не умеет работать, nginx склеивает пакеты
обратно, что в конечном итоге дает возможность нормально работать ответам сервера.

Аддон конфигурировать не нужно. На стороне интеграции необходимо обновиться до версии не ниже `v0.4.2` и выключить настройку 
`Имитация ответа`

На стороне меги поменять порт сервера c 8123 на 8124
